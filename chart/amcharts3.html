<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<!-- Styles -->
	<style>
	#chartdiv {
	  width: 100%;
	  height: 500px;
	}						
	</style>
	
	<!-- Resources -->
	<script type="text/javascript" src="js/amcharts.js" ></script>
	<script type="text/javascript" src="js/serial.js" ></script>
	<script type="text/javascript" src="js/light.js" ></script>	
	
	<script type="text/javascript" src="js/jquery-3.1.1.min.js" ></script>
	
	<!-- Chart code -->
	<script>
		var chart = AmCharts.makeChart("chartdiv", {
		  "type": "serial",
		  "theme": "light",
		  "dataDateFormat": "YYYY-MM-DD",
		  //Y left
		  "valueAxes": [{
		    "id": "y_total",
		    "title": "Total",
		    "position": "left",
		    "autoGridCount": false,
		    "labelFunction": function(value) {
		      return "$" + Math.round(value);
		    }
		  }, {//Y right
		    "id": "y_count",
		    "title": "Count",
		    "gridAlpha": 0,
		    "position": "right",
		    "autoGridCount": false,
		  }],
		  //bar total
		  "graphs": [{
		    "id": "bar_total",
		    "valueAxis": "y_total",
		    "lineColor": "#62cf73",
		    "fillColors": "#62cf73",
		    "fillAlphas": 1,
		    "type": "column",
		    "title": "Total",
		    "valueField": "total",
		    "clustered": false,
		    "columnWidth": 0.3,
		    "legendValueText": "$[[value]]",
		    "balloonText": "[[title]]<br /><b style='font-size: 130%'>$[[value]]</b>",
		    "precision": 2
		  }, {//line count
		    "id": "line_count",
		    "valueAxis": "y_count",
		    "bullet": "round",
		    "bulletBorderAlpha": 1,
		    "bulletColor": "#FFFFFF",
		    "bulletSize": 5,
		    "hideBulletsCount": 50,
		    "lineThickness": 2,
		    "lineColor": "#20acd4",
		    "type": "smoothedLine",
		    "title": "Count",
		    "useLineColorForBulletBorder": true,
		    "valueField": "count",
		    "balloonText": "[[title]]<br /><b style='font-size: 130%'>[[value]]</b>"
		  }],
		  //x
		  "categoryField": "date",
		  "categoryAxis": {
		    "parseDates": true,
		    "dashLength": 1,
		    "minorGridEnabled": true,
//		    "minPeriod":"DD",
//			"period":"DD",
			"period":"YYYY",
			"equalSpacing": true,
			"dateFormats":[{period:'fff',format:'JJ:NN:SS'},
							{period:'ss',format:'JJ:NN:SS'},
							{period:'mm',format:'JJ:NN'},
							{period:'hh',format:'JJ:NN'},
							{period:'DD',format:'MMM DD'},
							{period:'WW',format:'MMM DD'},
							{period:'MM',format:'MMM YYYY'},
							{period:'YYYY',format:'MMM YYYY'}],
							
		  },		  
		  //others
		  "chartCursor": {
		    "pan": true,
		    "valueLineEnabled": true,
		    "valueLineBalloonEnabled": true,
		    "cursorAlpha": 0,
		    "valueLineAlpha": 0.2
		  },

		  "legend": {
		    "useGraphSettings": true,
		    "position": "top"
		  },
		  "balloon": {
		    "borderThickness": 1,
		    "shadowAlpha": 0
		  },
		  //data
		  "dataProvider":
			[{
				"date": "2013-01-16",
				"count": 71,
				"total": 6582
			}, {
				"date": "2013-01-17",
				"count": 74,
				"total": 6820.5
			}]			  

		});
		
		
		function updateChart(data){
			chart.dataProvider = data;
			chart.validateNow();
			chart.validateData();
		} 		
		
		
		$(function(){
			$('#btn-range').click(function(){
				$.ajax('json/date_range.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data);
			    }).fail(function(data) {
			    });
			});
			
			$('#btn-week').click(function(){
				$.ajax('json/date_week.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data);
			    }).fail(function(data) {
			    });
			})	
			
			$('#btn-year').click(function(){
				$.ajax('json/date_year.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data);
			    }).fail(function(data) {
			    });
			})		
			
			$('#btn-month').click(function(){
				$.ajax('json/date_month.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data);
			    }).fail(function(data) {
			    });
			})				
		})
		

		
		
	</script>	
	<body>
		<!-- HTML -->
		<div id="chartdiv"></div>	
		
		<button id="btn-range">Date Range</button>
		<button id="btn-week">Week</button>
		<button id="btn-month">Month</button>
		<button id="btn-year">Year</button>
	</body>
</html>
